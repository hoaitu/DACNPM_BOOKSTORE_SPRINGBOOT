<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<style>
.error {
	color: red;
}
</style>
<title>WRITER SignUp</title>
</head>
<body>
	<!-- Where tag link + header -->
	<div th:insert="~{link :: links}"></div>
	<!-- Add your site or application content here -->
	<!--Header Area Start-->
	<!-- Tag HEADER -->
	<div th:insert="~{header :: header_in}"></div>
	<!-- Mobile Menu End -->

	<!-- Breadcrumbs Area Start -->
	<div class="breadcrumbs-area">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div class="breadcrumbs">
						<h2>ÄÄng kÃ­</h2>
						<ul class="breadcrumbs-list">
							<li><a title="Return to Home" href="/">Trang chá»§</a></li>
							<li>ÄÄng kÃ­</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Breadcrumbs Area Start -->

	<!-- Loging Area Start -->
	<div class="login-account section-padding">
		<div class="container">
			<div class="row"
				style="display: flex; align-items: center; justify-content: center;">
				<div class="col-md-6 col-sm-6">

					<div th:if="${message != null}">
						<p class="text-warning">[[${message}]]</p>
					</div>


					<!--TU:  add action: from controller ; Object from Controller-@ModelAttribute  -->

					<form name="form1" id="form1" th:action="@{/signup}"
						th:object="${user}" class="create-account-form" method="post"
						onsubmit="matchpass()">

						<h2 class="heading-title">Táº¡o tÃ i khoáº£n má»i</h2>
						<p id="result"></p>
						<p class="form-row">
							*User Name: <input style="outline: none;" id="cname" type="email"
								name="userName" size="40" placeholder="Äá»a chá» email"
								th:field="*{username}" required>

						</p>
						<!-- TU: Where show log mess if User extis in DB; Ajax under same Page  -->

						<div id="error-name" class="error"></div>


						</p>

						<p class="form-row">


							*Email: <input style="outline: none;" type="text" id="email"
								placeholder="UserName" th:field="*{email}" required>
						</p>

						<p class="form-row">
							*Password: <input style="outline: none;" type="password"
								name="password" placeholder="Máº­t kháº©u" id="txtPassword"
								th:field="*{password}" pattern=".{6,}"
								title="8 characters minimum" required />
						</p>

						<p class="form-row">
							*RePassword: <input style="outline: none;" type="password"
								name="cfpassword" placeholder="Nháº­p láº¡i máº­t kháº©u"
								id="txtConfirmPassword" required />
						</p>


						Gender: <select name="gender" class="form-control" required>
							<option value="Nam">Nam</option>
							<option value="Nữ">Nu</option>
							<option value="Khác">Khac</option>

						</select></br>
						<!-- kiem tra co dung dinh dang dd/mm/yyyy min:1950-01-01, max:2030-12-31 (tran) -->
						<p class="form-row">
							Date Of Birtth: <input name="dateOfBirth" type="datetime"
								class="form-control" placeholder="DD/MM/YYYY" value=""
								min="1997-01-01" max="2030-12-31"
								pattern="[0-9]{2}/[0-9]{2}/[0-9]{4}\b" required />

						</p>
						<!-- kiem tra dinh dang so dien thoai Viet Nam (tran) -->
						<p class="form-row">
							Phone: <input th:field="*{phone}" Class="form-control"
								pattern="([\+84|84|0]+(3|5|7|8|9|1[2|6|8|9]))+([0-9]{8})\b"
								required />
						</p>

						<p class="form-row">
							Address: <input th:field="*{address}" Class="form-control"
								required />
						<div id="error-address" class="error"></div>
						<p th:if="${#fields.hasErrors('address')}" th:errors="*{address}"
							required></p>
						</p>



						<div class="submit">
							<button name="submitcreate" id="submitcreate" type="submit"
								class="btn-default" value="Submit" onclick="return Validate()" />
							<span> <i class="fa fa-user left"></i> Lưu
							</span>
							</button>

							<button name="submitcreate" id="submitcreate" type="submit"
								class="btn-default" style="color: red;">
								<span> <i class="fa fa-user left"></i> Hủy
								</span>
							</button>

						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	222


	<!-- 	/**Chức năng nhập lại pass  + nhập đúng form email dùng Java Script*/ -->
	<!-- TU: Funtion : input RePassWord + Form when write Email is right Using Java Script -->

	<script type="text/javascript">
		function Validate() {
			var email = document.getElementById('email');
			var cname = document.getElementById('cname');
			var password = document.getElementById("txtPassword").value;
			var confirmPassword = document.getElementById("txtConfirmPassword").value;

			/* 	var email = document.getElementById('idemail'); */
			var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

			if (!filter.test(email.value)) {
				alert('Email: Hay nhap dia chi email hop le.\nExample@gmail.com');
				email.focus;
				return false;
			}
			if (!filter.test(cname.value)) {
				alert('User Name: Hay nhap dia chi email hop le.\nExample@gmail.com');
				email.focus;
				return false;
			}
			if (password != confirmPassword) {
				alert("Passwords do not match.");
				return false;
			}
			return true;
			alert('OK roi day, Email nay hop le.');
			alert('OK roi day, Email nay hop le.');
		};
	</script>

	<!--TU: Ajax; Check Email Exits in DB; if have show mess; userName is name in Input + name in funtion checkUserName() in Controller  -->
	<script type="text/javascript">
		$(document)
				.ready(
						function() {
							$("#cname")
									.blur(
											function() {
												var value = $(this).val();
												console.log("value: " + value);

												$
														.ajax(
																{
																	method : 'GET',
																	url : 'checkUserName',
																	dataType : 'text',
																	cache : false,
																	data : {
																		userName : value,
																	}
																})
														.done(
																function(data) {
																	console
																			.log(data)
																	if (data == "true") {
																		$(
																				"#error-name")
																				.text(
																						"Tên người dùng này đã tồn tại, xin thử lại tên khác");
																	} else if (value == '') {
																		$(
																				"#error-name")
																				.text(
																						"Vui lòng nhập tên người dùng");
																	} else {
																		$(
																				"#error-name")
																				.text(
																						"ahii");
																	}

																	console
																			.log("data laf: "
																					+ data);

																	console
																			.log("value laf: "
																					+ value);
																});

											});
						});
	</script>


	<!-- Loging Area End -->
	<!-- Footer Area Start -->
	<!-- Footer Area Start -->

	<!-- Footer Area Start -->
	<!-- NÆ I Gáº®N FOOTER -->
	<div th:insert="~{footer :: footer_in}"></div>
</body>
</html>